# 天体系统模拟器

一个基于Python的天体物理模拟系统，使用PyOpenGL进行3D渲染，支持CUDA加速计算。

## 项目简介

天体系统模拟器是一个功能强大的教育性和研究性工具，用于模拟和可视化天体系统的运动。该模拟器基于牛顿万有引力定律和开普勒定律，能够准确模拟从简单的双星系统到复杂的星系碰撞等各种天体物理现象。

### 主要特性

- **真实的物理模拟**：基于牛顿引力定律和开普勒定律
- **高性能计算**：支持CUDA并行计算加速
- **3D可视化**：使用PyOpenGL进行实时3D渲染
- **多种天体类型**：恒星、行星、卫星、小行星、黑洞
- **预设场景库**：太阳系、双星系统、三星系统、小行星带、黑洞系统
- **交互式控制**：实时调整参数、暂停/继续模拟、时间加速
- **数据分析**：实时显示系统能量、角动量、轨道参数
- **场景保存/加载**：保存和加载自定义天体系统

## 安装要求

### 系统要求

- Python 3.7 或更高版本
- OpenGL 3.3 或更高版本
- 支持CUDA的NVIDIA显卡（可选，用于加速计算）

### Python依赖包

```bash
pip install pygame
pip install PyOpenGL
pip install PyOpenGL-accelerate
pip install numpy
pip install Pillow
pip install numba  # 用于JIT编译优化
pip install pycuda  # 可选，用于CUDA加速
```

### 可选依赖

```bash
pip install matplotlib  # 用于数据可视化
pip install scipy      # 用于高级数值计算
```

## 快速开始

### 运行模拟器

```bash
python celestial_simulator.py
```

### 基本操作

#### 3D视图控制

- **鼠标左键拖拽**：旋转视角
- **鼠标右键拖拽**：平移视角
- **鼠标滚轮**：缩放视图
- **W/A/S/D键**：移动相机位置
- **R键**：重置相机视角

#### 模拟控制

- **空格键**：暂停/继续模拟
- **+/-键**：增加/减少时间流速
- **C键**：清空所有天体
- **S键**：保存当前场景
- **L键**：加载场景

#### 预设场景

- **1键**：加载太阳系
- **2键**：加载双星系统
- **3键**：加载随机系统

### 创建天体

在控制面板中可以创建新的天体：

1. 选择天体类型（恒星、行星、卫星、小行星）
2. 设置天体名称
3. 输入质量、半径、初始位置和速度
4. 点击"创建天体"按钮

## 物理模型

### 引力计算

模拟器使用牛顿万有引力定律：

```
F = G * m₁ * m₂ / r²
```

其中：
- F 是引力大小
- G 是引力常数 (6.67430×10⁻¹¹ N·m²/kg²)
- m₁, m₂ 是两个天体的质量
- r 是天体间的距离

### 数值积分

支持两种积分方法：

1. **欧拉法**：简单快速，但精度较低
2. **Runge-Kutta 4阶法**：精度高，稳定性好，默认使用

### 碰撞检测

当两个天体的距离小于它们的半径之和时，会发生碰撞。碰撞后天体会合并，遵循动量守恒和能量守恒定律。

## 预设场景

### 1. 太阳系

包含太阳和八大行星的精确模型，基于真实的轨道参数和质量数据。完美展示了开普勒定律和牛顿引力定律的应用。

### 2. 双星系统

两颗恒星相互围绕，周围有行星运行。展示复杂的多体引力系统和轨道稳定性。约有一半的恒星系统都是双星或多星系统。

### 3. 三星系统

经典的三体问题实例，展示混沌运动和不稳定轨道。初始条件的微小变化会导致完全不同的演化结果。

### 4. 小行星带

模拟火星和木星之间的小行星带，包含50多个小天体。展示群体运动的统计特性和引力扰动对轨道的影响。

### 5. 黑洞系统

超大质量黑洞周围的恒星运动，展示强引力场中的轨道进动和相对论效应。基于银河系中心黑洞的观测数据。

## 高级功能

### CUDA加速

如果安装了pycuda并且系统支持CUDA，可以启用CUDA加速来提高计算性能：

```python
# 在config.py中设置
USE_CUDA = True
```

### 相对论修正

可以启用广义相对论修正来模拟强引力场中的效应：

```python
# 在config.py中设置
ENABLE_RELATIVISTIC_CORRECTIONS = True
```

### 自定义场景

可以通过修改scene_manager.py来添加自定义场景：

```python
def load_custom_scene(self, bodies: list):
    """加载自定义场景"""
    bodies.clear()
    
    # 添加你的天体
    custom_body = CelestialBody(
        name='自定义天体',
        body_type='planet',
        mass=1e24,
        radius=6000,
        position=[1000000, 0, 0],
        velocity=[0, 30, 0],
        color=(0.5, 0.5, 1.0)
    )
    bodies.append(custom_body)
```

## 性能优化

### 内存管理

- 使用对象池重用天体对象
- 限制轨迹长度避免内存泄漏
- 及时清理不再使用的天体

### 计算优化

- 使用空间分割减少不必要的引力计算
- 实现LOD（细节层次）系统
- 并行计算多个天体的运动

### 渲染优化

- 视锥剔除只渲染可见天体
- 使用显示列表缓存几何体
- 批量渲染减少OpenGL调用

## 教育价值

### 物理概念

- **万有引力定律**：理解引力的基本性质
- **开普勒定律**：掌握行星运动规律
- **能量守恒**：分析系统的稳定性
- **混沌理论**：探索对初始条件的敏感性
- **相对论效应**：了解强引力场中的现象

### 实际应用

- **航天工程**：轨道设计和任务规划
- **天体物理学**：研究星系演化和结构形成
- **教育领域**：直观展示抽象物理概念
- **科学研究**：验证理论模型和数值方法

## 扩展开发

### 添加新功能

1. **新的天体类型**：修改physics_engine.py中的CelestialBody类
2. **新的物理模型**：在physics_engine.py中添加新的计算方法
3. **新的渲染效果**：修改renderer.py中的渲染函数
4. **新的UI控件**：在ui_manager.py中添加新的UI元素

### 性能监控

模拟器内置了性能监控功能，可以实时显示：

- FPS（帧率）
- 物理计算时间
- 渲染时间
- 内存使用情况

### 调试工具

启用调试模式可以获得更多调试信息：

```python
# 在config.py中设置
DEBUG_MODE = True
SHOW_PHYSICS_DEBUG_INFO = True
```

## 贡献指南

欢迎提交问题报告、功能建议或代码贡献！

### 开发环境设置

1. Fork项目仓库
2. 创建虚拟环境
3. 安装依赖包
4. 运行测试

### 代码规范

- 遵循PEP 8 Python编码规范
- 添加适当的文档字符串
- 保持代码简洁易读
- 添加单元测试

## 许可证

本项目采用MIT许可证，详情请见LICENSE文件。

## 致谢

- 感谢开源社区提供的优秀库和工具
- 感谢天体物理学家的理论指导
- 感谢所有贡献者的支持和帮助

## 联系方式

如有问题或建议，请通过以下方式联系我们：

- 项目主页：https://github.com/celestial-simulator/celestial-simulator
- 问题跟踪：https://github.com/celestial-simulator/celestial-simulator/issues
- 邮件：contact@celestial-simulator.com

---

**探索宇宙奥秘，理解天体运动！** 🌌✨